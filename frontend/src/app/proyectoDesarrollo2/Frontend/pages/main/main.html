<div class="dashboard-container">
  <!-- Sidebar -->
  <aside class="sidebar" [class.collapsed]="!sidebarOpen">
    <div class="logo-section">
      <div class="logo">EB</div>
      <div class="logo-text">
        <h1>EcoBahía</h1>
        <p>Sistema de Recolección</p>
      </div>
    </div>

    <nav class="menu">
      <button 
        *ngFor="let item of menuItems" 
        [class.active]="activeSection === item.id"
        (click)="setActiveSection(item.id)">
        <i [class]="item.icon"></i>
        <span>{{ item.label }}</span>
      </button>
    </nav>

    <div class="user-section">
      <div class="user-info">
        <div class="user-avatar">A</div>
        <span>Admin</span>
      </div>
      <button class="logout-btn" (click)="logout()">
        <i class="icon-logout"></i>
        Cerrar sesión
      </button>
    </div>
  </aside>

  <!-- Main Content -->
  <main class="main-content">
    <!-- Header -->
    <header class="header">
      <div class="header-left">
        <button (click)="toggleSidebar()" class="toggle-btn">
          {{ sidebarOpen ? '✕' : '☰' }}
        </button>
        <h2>Bienvenido a EcoBahía</h2>
      </div>
      <div class="header-right">
        Estado de rutas, horarios, avisos y vehículos
      </div>
    </header>

    <!-- Content -->
    <div class="content">
      <!-- Cards Row -->
      <div class="cards-grid">
        <!-- Vehículo Actual -->
        <div class="card">
          <h3>Vehículo actual</h3>
          <div class="vehicle-info">
            <div class="status-badge">
              <span class="status-dot"></span>
              En ruta • M. García
            </div>
            <div class="progress-bar">
              <div class="progress" [style.width.%]="vehiculoActual.progreso"></div>
            </div>
            <div class="percentage">{{ vehiculoActual.progreso }}%</div>
            <div class="info-row">
              <span>Placa:</span>
              <strong>{{ vehiculoActual.placa }}</strong>
            </div>
            <button class="btn-primary" (click)="verRutaActiva()">
              Ver ruta activa
            </button>
          </div>
        </div>

        <!-- Próximo Camión -->
        <div class="card">
          <h3>Próximo camión</h3>
          <div class="truck-info">
            <div class="truck-icon">
              <i class="icon-truck"></i>
            </div>
            <div class="truck-details">
              <p class="route-name">{{ proximoCamion.ruta }}</p>
              <p class="zone">{{ proximoCamion.zona }}</p>
            </div>
            <div class="divider"></div>
            <div class="time-section">
              <span class="time-label">Hora estimada:</span>
              <span class="time-value">{{ proximoCamion.hora }}</span>
            </div>
          </div>
        </div>

        <!-- Eficiencia -->
        <div class="card">
          <h3>Eficiencia</h3>
          <div class="efficiency">
            <div class="big-number">{{ eficiencia.porcentaje }}%</div>
            <p class="efficiency-label">Eficiencia del día</p>
            <div class="stats">
              <div class="stat-item">
                <span>KM hoy:</span>
                <strong>{{ eficiencia.kmHoy }}</strong>
              </div>
              <div class="stat-item">
                <span>Kg recolectados:</span>
                <strong>{{ eficiencia.kgRecolectados | number }}</strong>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- Mapa - AQUÍ SE INTEGRA TU SERVICIO -->
      <div class="map-card">
        <div class="map-header">
          <h3>
            <i class="icon-map"></i>
            Mapa de Rutas - Buenaventura
          </h3>
          <div class="map-controls">
            <button class="map-btn" (click)="verTodasRutas()">
              Ver todas las rutas
            </button>
            <button class="map-btn active" (click)="verVehiculosActivos()">
              Vehículos activos
            </button>
          </div>
        </div>
        <!-- Contenedor del mapa de Leaflet -->
        <div id="map" class="map-container"></div>
      </div>

      <!-- Avisos -->
      <div class="card avisos-card">
        <h3>Últimos avisos</h3>
        <div class="avisos-list">
          <div class="aviso" *ngFor="let aviso of avisos" [class]="'aviso-' + aviso.tipo">
            <div class="aviso-icon">
              <i class="icon-alert"></i>
            </div>
            <div class="aviso-content">
              <p class="aviso-title">{{ aviso.titulo }}</p>
              <p class="aviso-time">{{ aviso.tiempo }}</p>
            </div>
            <button class="aviso-action" (click)="marcarLeido(aviso.id)">
              Marcar leído
            </button>
          </div>
        </div>
      </div>
    </div>
  </main>
</div>
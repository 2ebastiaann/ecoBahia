<div class="map-page-container">
  <!-- Header bar with buttons -->
  <div class="map-header-bar">
    <div class="header-left">
      <button class="btn btn-back" (click)="router.navigate(['/dashboard'])">â¬… Volver</button>
    </div>

    <div class="header-center">
      <h2>Gestor de Rutas</h2>
    </div>

    <div class="header-right">
      <button class="btn btn-primary" (click)="empezarCrearRuta()" *ngIf="!creandoRuta">
        âž• Crear Ruta
      </button>

      <button class="btn btn-success" (click)="guardarRuta()" *ngIf="creandoRuta">
        âœ” Guardar Ruta
      </button>

      <button class="btn btn-danger" (click)="limpiarMapa()" *ngIf="creandoRuta">
        ðŸ—‘ Limpiar
      </button>
    </div>
  </div>

  <!-- Main content area: map + sidebar -->
  <div class="map-content-wrapper">
    <!-- Map container (left side, full height) -->
    <div class="map-section">
      <div id="mapContainer"></div>
    </div>

    <!-- Sidebar with routes list (right side) -->
    <div class="routes-sidebar">
      <h3>Rutas Registradas</h3>
      <div class="routes-list-container">
        <div class="ruta-item" *ngFor="let r of rutas">
          <div class="ruta-info">
            <div class="ruta-name">{{ r.nombre_ruta }}</div>
            <div class="ruta-color" [style.background]="r.color_hex || '#10b981'"></div>
          </div>
          <button class="btn-view" (click)="mostrarRuta(r)">Ver</button>
        </div>
        <div *ngIf="rutas.length === 0" class="no-routes">
          No hay rutas registradas aÃºn
        </div>
      </div>
    </div>
  </div>

  <!-- Modal -->
  <div class="modal-overlay" *ngIf="mostrarModalNombreRuta" (click)="mostrarModalNombreRuta = false">
    <div class="modal" (click)="$event.stopPropagation()">
      <h3>Crear Nueva Ruta</h3>

      <div class="modal-form">
        <!-- Nombre de la ruta -->
        <div class="form-group">
          <label>Nombre de la ruta</label>
          <input 
            type="text" 
            [(ngModel)]="nombreRuta" 
            placeholder="Ej: Ruta Centro - Zona Norte" 
            class="form-input"
            autofocus>
        </div>

        <!-- Color de la ruta -->
        <div class="form-group">
          <label>Color de la ruta</label>
          <div class="color-picker-group">
            <input 
              type="color" 
              [(ngModel)]="rutaColor" 
              class="color-picker" />
            <div 
              [style.background]="rutaColor" 
              class="color-preview">
            </div>
            <div class="color-info">
              <span class="color-value">{{ rutaColor }}</span>
            </div>
          </div>
        </div>
      </div>

      <div class="modal-buttons">
        <button class="btn btn-cancel" (click)="mostrarModalNombreRuta = false">
          Cancelar
        </button>
        <button class="btn btn-primary" (click)="confirmarNombreRuta()">
          Comenzar a Dibujar
        </button>
      </div>
    </div>
  </div>

</div>
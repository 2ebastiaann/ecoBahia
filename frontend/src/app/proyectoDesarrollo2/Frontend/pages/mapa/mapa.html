<div class="map-page-container">

  <!-- CONTENEDOR DE NOTIFICACIONES -->
  <app-notification-container></app-notification-container>

  <!-- BARRA SUPERIOR -->
  <div class="map-header-bar">

    <div class="header-left">
      <button class="btn btn-back" (click)="router.navigate(['/main'])">
        â¬… Volver
      </button>
    </div>

    <div class="header-center">
      <h2>Gestor de Rutas</h2>
    </div>

    <div class="header-right">

      <!-- Crear ruta -->
      <button class="btn btn-primary"
              *ngIf="!creandoRuta && esAdmin"
              (click)="empezarCrearRuta()">
        âž• Crear Ruta
      </button>

      <!-- Guardar ruta -->
      <button class="btn btn-success"
              *ngIf="creandoRuta && esAdmin"
              (click)="guardarRuta()">
        âœ” Guardar Ruta
      </button>

      <!-- Limpiar -->
      <button class="btn btn-danger"
              *ngIf="creandoRuta && esAdmin"
              (click)="limpiarMapa()">
        ðŸ—‘ Limpiar
      </button>

    </div>

  </div>

  <!-- CONTENIDO PRINCIPAL -->
  <div class="map-content-wrapper">

    <!-- MAPA -->
    <div class="map-section">
      <div id="mapContainer"></div>
    </div>

    <!-- SIDEBAR CON LISTA DE RUTAS -->
    <div class="routes-sidebar">

      <h3>Rutas Registradas</h3>

      <div class="routes-list-container">

        <!-- Cada ruta -->
        <div class="ruta-item"
             *ngFor="let r of rutas">

          <div class="ruta-info">
            <div class="ruta-name">{{ r.nombre_ruta }}</div>
            <div class="ruta-color"
                 [style.background]="r.color_hex || '#10b981'">
            </div>
          </div>

          <div class="ruta-actions">
            <button class="btn-view"
                    (click)="mostrarRuta(r)">
              Ver
            </button>
          </div>

        </div>

        <!-- Si no hay rutas -->
        <div class="no-routes" *ngIf="rutas.length === 0">
          No hay rutas registradas aÃºn
        </div>

      </div>

    </div>

  </div>


  <!-- MODAL CREAR RUTA -->
  <div class="modal-overlay"
       *ngIf="mostrarModalNombreRuta"
       (click)="mostrarModalNombreRuta = false">

    <div class="modal"
         (click)="$event.stopPropagation()">

      <h3>Crear Nueva Ruta</h3>

      <div class="modal-form">

        <!-- Nombre -->
        <div class="form-group">
          <label>Nombre de la ruta</label>
          <input type="text"
                 [(ngModel)]="nombreRuta"
                 placeholder="Ej: Calle 6 - Zona Centro"
                 class="form-input"
                 autofocus>
        </div>

        <!-- Color -->
        <div class="form-group">
          <label>Color de la ruta</label>

          <div class="color-picker-group">

            <input type="color"
                   class="color-picker"
                   [(ngModel)]="rutaColor">

            <div class="color-preview"
                 [style.background]="rutaColor">
            </div>

            <div class="color-info">
              <span>{{ rutaColor }}</span>
            </div>

          </div>

        </div>

      </div>

      <!-- Botones -->
      <div class="modal-buttons">

        <button class="btn btn-cancel"
                (click)="mostrarModalNombreRuta = false">
          Cancelar
        </button>

        <button class="btn btn-primary"
                (click)="confirmarNombreRuta()"
                *ngIf="esAdmin">
          Comenzar a Dibujar
        </button>

      </div>

    </div>

  </div>

</div>
